<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="https://www.springframework.org/schema/integration"
			 xmlns:xsi="https://www.w3.org/2001/XMLSchema-instance"
			 xmlns:beans="https://www.springframework.org/schema/beans"
			 xmlns:p="https://www.springframework.org/schema/p"
			 xsi:schemaLocation="https://www.springframework.org/schema/beans
								 https://www.springframework.org/schema/beans/spring-beans.xsd
								 https://www.springframework.org/schema/integration
								 https://www.springframework.org/schema/integration/spring-integration.xsd">
	<annotation-config/>

	<channel id="requests">
		<queue/>
		<interceptors>
			<beans:bean class="org.springframework.batch.integration.async.StepExecutionInterceptor"/>
		</interceptors>
	</channel>

	<channel id="replies">
		<queue/>
	</channel>

	<gateway service-interface="org.springframework.batch.item.ItemProcessor" id="processor"
			 default-reply-timeout="1000"
			 default-request-channel="requests" default-reply-channel="replies"/>

	<service-activator input-channel="requests" output-channel="replies" ref="doubler">
		<poller fixed-rate="100"/>
	</service-activator>

	<beans:bean id="doubler"
				class="org.springframework.batch.integration.async.PollingAsyncItemProcessorMessagingGatewayTests$Doubler"/>

	<beans:bean class="org.springframework.batch.core.scope.StepScope" p:proxyTargetClass="true"/>
</beans:beans>